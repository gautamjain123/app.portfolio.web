<div class="ai-card">
  <div class="ai-header">
    <div>
      <h4 class="mb-1 fw-bold title">ðŸŽ¯ Interview Code Review</h4>
      <p class="mb-0 subtitle">Paste HTML/CSS/TS/Angular code â†’ get review + improved code + interview questions</p>
    </div>

    <div class="d-flex gap-2 flex-wrap justify-content-end">
      <span class="badge-soft" *ngIf="timeTakenMs">
        Time: <b class="ms-1">{{ timeTakenMs }}ms</b>
      </span>
    </div>
  </div>

  <div class="ai-controls row g-3">
    <div class="col-12">
      <label class="form-label fw-semibold text-white">Paste your code</label>
      <textarea
        class="form-control ai-textarea font-monospace"
        rows="12"
        [(ngModel)]="code"
        placeholder="Paste HTML / CSS / TS / Angular..."
      ></textarea>
      <div class="mt-2 d-flex justify-content-between small text-white-50">
        <span>Tip: paste a full component/service for best results.</span>
        <span>{{ code.length }} chars</span>
      </div>
    </div>

    <div class="col-12 d-flex justify-content-end gap-2">
      <button class="btn btn-outline-light ai-btn" (click)="clearAll()" [disabled]="loading">Clear</button>

      <button class="btn btn-light ai-btn-primary" (click)="roastCode()" [disabled]="loading || !code.trim()">
        <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>
        Analyze ðŸŽ¯
      </button>
    </div>
  </div>

  <div class="typing mt-4" *ngIf="loading">
    <div class="typing-dot"></div>
    <div class="typing-dot"></div>
    <div class="typing-dot"></div>
    <span class="ms-2 text-white-50">Interview review in progress...</span>
  </div>

  <div class="alert alert-danger mt-4" *ngIf="errorMsg">
    <b>Error:</b> {{ errorMsg }}
  </div>

  <div class="ai-result mt-4" *ngIf="result && !loading">
    <div class="result-header">
      <h6 class="mb-0 fw-bold">âœ… Result</h6>
      <button class="btn btn-sm btn-outline-light" (click)="copyAll()">Copy All</button>
    </div>

    <div class="result-body">
      <div class="ai-accordion">
        <div class="acc-item" *ngFor="let s of sections">
          <button class="acc-header" (click)="toggleSection(s)">
            <span class="left">
              <span class="icon">{{ s.icon }}</span>
              <span class="label">{{ s.title }}</span>
            </span>

            <span class="right">
              <button class="mini-btn" (click)="$event.stopPropagation(); copySection(s.key)">
                Copy
              </button>
              <span class="chev" [class.open]="s.open">âŒ„</span>
            </span>
          </button>

          <div class="acc-body" *ngIf="s.open">
            <pre class="raw">{{ s.content }}</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
